# AWS IAM Identity Center #iam
collapsed:: true
	- One login for all your
		- AWS accounts in AWS Organizations
		- Business cloud apps
		- SAML 2.0 apps
		- EC2 Windows Instances
	- **Identity Provider**
		- Built-in identity store
		- Third party: AD, OneLogin...
	- **Multi-Account Permissions**
		- Permission Sets -> collection of one or more IAM Policies assigned to users and groups to define AWS access
	- **App Assignments**
		- SSO access to many SAML 2.0 business apps (Salesforce, Microsoft 365)
		- Provide required URLs, certificates and metadata
	- **Attibuted-Bases Access Control (ACAB)**
		- fine-grained permissions based on users' attributes stored in IAM Identity Center Identity Store
		- Use case: Define permissions once, then modify AWS access by changing the attributes
- # AWS Control Tower #iam
  collapsed:: true
	- Set up and govern a secure and compliant multi-account AWS environment based on best practices
	- **Benefits**:
		- Automate the set up of your environment in a few clicks
		- Automate ongoing policy management using guardrails
		- Detect policy violations and remediate them
		- Monitor compliance through an interactive dashboard
	- It run on top of AWS Organizations, it automatically sets up AWS Organizations to organize accounts and implement SCPs
	- **Account Factory**
		- Automates account provisioning and deployments
		- Uses AWS Service Catalog to provision new AWS accounts
		- Enables you to create pre-approved baselines and configuration options for AWS accounts in your organization
	- **Policy Violations**
		- **Guardrail**:
			- **Preventive**: using SCPs
			- **Detective**: using AWS Config
			- Different levels:
				- **Mandatory** (required)
				- **Strongly recommendend** (optional)
				- **Elective** (optional)
- # AWS Resource Access manager (RAM) #iam
  collapsed:: true
	- Share AWS resources that you own with other AWS accounts
		- Avoid resource duplication
	- Some resources can be shared, but the most important for this exam is **VPC**
		- Each account is responsible for its own resources and cannot view, modify or delete other resources in other accounts
		- Anything deployed in the VPC can talk to other resources  in the VPC, using private IP
		- SGs from other accounts can be referenced for maximum security
		- Use cases:
			- Apps within the same trust boundaries
			- Apps with a high degree of interconnectivity
			- **Managed Prefix List**
				- A set of one or more CIDR blocks, making easier to configure and maintain SGs and route tables
				- Customer-managed (can be shared) or AWS-managed (cannot be shared)
	- **Route 53 Outbound Resolver**
		- Helps you scale forwarding rules to your DNS in case you have multiple accounts and VPC
- # CloudTrail #security
  collapsed:: true
	- Provides governance, compliance and audit for AWS accounts
		- Enabled by default
		- Historical event/API calls made
		- Can put logs into CloudWatch Logs or S3
		- A trail can be applied to all regions (default) or a single specific region
		- **If a resource was deleted in AWS, investigate CloudTrail first!**
		- 3 kind of events
			- **Management Events** (enabled by default): operation that are performed on resources in your AWS account (e.g., configuring security, routes, setting up logging...)
				- **Read events**
				- **Write events**
			- **Data Events** (disabled by default, high volume operations), e.g., Amazon S3 object-level activity, AWS Lambda function execution,...
			- **CloudTrail Insights Events**:
				- Enable it to **detect unusual activity** in your account
				- Analyzes normal management events to create a baseline. Then, continuously analyzes write events to detect unusual patterns.
					- Anomalies appear in the CloudTrail console
					- Event is sent to Amazon S3
					- An EventBridge event is generated (for automation needs)
			- **CloudTrail Event Retention**
				- Defaults to 90 days
				- To keep event beyond this period, log them to S3 and use Athena to query data.
			- **Integration with EventBridge**
				- Log API calls with CloudTrail, trigger an EventBridge event that notifies users via email (SNS) when a certain API calls is registered.
			- **How to react to events the fastest?**
				- Overall, CloudTrail may take up to 15' to deliver events
				- **EventBridge** (the fastest, most reactive way)
				- **CloudTrail Delivery in CloudWatch Logs**
					- Events are streamed (near real-time)
					- Can perform a metric filter to analyze occurrences and detect anomalies
				- **CloudTrail Delivery in S3**
					- Events are delivered every 5'
					- Long-term storage, cross accounting, analizing logs integrity
			- ## Solution Architecture: Delivery to S3
				- Sends from CloudTrail to S3 events every 5'
					- Benefit using S3 features
						- Versioning
						- MFA Delete Protection
						- S3 Lifecycle Policy
						- S3 Object Lock
						- Encryption
						- CloudTrail Log File Integrity validation (SHA-256)
				- Encryption could be enabled (SSE-S3 by default)
				- Notifications could be set in two ways
					- CloudTrail delivery notifications
					- S3 Events
			- ## Solution Architecture: Multi Account, Multi Region Logging
				- Centralized S3 bucket with a folder for each AWS account. Then, configure a S3 bucket policy for cross-account delivery
				- If account X wants to access its CloudTrail files, you can:
					- Create a cross-account role and assume the role
					- Edit the bucket policy to allow reading from account A
			- ## Solution Architecture: Alert for API calls
				- Stream CloudTrail events to CloudWatch Logs. Then, create metric filters and set alarms for those filters. If the alarms put on, trigger a SNS notification (this could trigger a Lambda or SQS queue as well)
				- Use cases:
					- Count occurrences of specific AWS API call
					- Count # of API calls per user
					- Detect high level of Denied API calls (unusual activity)
			- ## Solution Architecture: Organizational Trail
				- **Organizational Trail is created in the management account**
				- Any accounts in the AWS Organization will send events to the management account organizational trail
- # KMS #security
	-